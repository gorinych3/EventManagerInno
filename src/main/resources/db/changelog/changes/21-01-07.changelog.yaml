databaseChangeLog:

#  - changeSet:
#      id: dropAllTables
#      author: egor.ganzya
#      changes:
#        - sql:
#            sql: DROP TABLE IF EXISTS events_users CASCADE;
#              DROP TABLE IF EXISTS user_role CASCADE;
#              DROP TABLE IF EXISTS users CASCADE;
#              DROP TABLE IF EXISTS events CASCADE;
#              DROP TABLE IF EXISTS teams_users CASCADE;
#              DROP TABLE IF EXISTS teams CASCADE;
#              DROP TABLE IF EXISTS play_actions CASCADE;
#              DROP TABLE IF EXISTS actions CASCADE;
  - changeSet:
      id: create_new_users
      author: egor.ganzya
      changes:
        - sql:
            sql: create table users
              (
              user_id         bigint generated by default as identity
              constraint users_pkey
              primary key,
              activation_code varchar(255),
              active          boolean not null,
              email           varchar(255),
              password        varchar(255),
              phone_number    varchar(255),
              username        varchar(40)
              );
  - changeSet:
      id: create_new_teams
      author: egor.ganzya
      changes:
        - sql:
            sql: create table teams
              (
              team_id   bigint generated by default as identity
              constraint teams_pkey
              primary key,
              team_name varchar(255)
              );
  - changeSet:
      id: create_new_action
      author: egor.ganzya
      changes:
        - sql:
            sql: create table actions
              (
              action_id       bigint generated by default as identity
              constraint actions_pkey
              primary key,
              action_name     varchar(255),
              description     varchar(255),
              players_on_team integer not null,
              teams           integer not null
              );
  - changeSet:
      id: create_new_play_action
      author: egor.ganzya
      changes:
        - sql:
            sql: create table play_actions
              (
              play_action_id bigint generated by default as identity
              constraint play_actions_pkey
              primary key,
              action_id      bigint
              constraint fkm4bt2featnbo7g0m36sdyy7o6
              references actions,
              master_team_id bigint
              constraint fks9bcjy9rnmav5j05mp1k9a0ck
              references teams,
              slave_team_id  bigint
              constraint fk2hv9fysrlblgiu7vh8od80p5y
              references teams
              );
  - changeSet:
      id: create_new_teams_users
      author: egor.ganzya
      changes:
        - sql:
            sql: create table teams_users
              (
              team_id bigint not null
              constraint fk17jdrnq003lyba5o79uruykxt
              references users,
              user_id bigint not null
              constraint fkp8xgd2icm3bw9w9foklf2cr6i
              references teams,
              constraint teams_users_pkey
              primary key (user_id, team_id)
              );
  - changeSet:
      id: create_new_events
      author: egor.ganzya
      changes:
        - sql:
            sql: create table events
              (
              event_id    bigint generated by default as identity
              constraint events_pkey
              primary key,
              create_date timestamp,
              event_name  varchar(255),
              action_id   bigint
              constraint fk8gmc790iu301fxg3v179vrg44
              references actions
              );
  - changeSet:
      id: create_new_events_users
      author: egor.ganzya
      changes:
        - sql:
            sql: create table events_users
              (
              event_id bigint not null
              constraint fkd46my3jbxrdmcd3m2dryyc295
              references events,
              user_id  bigint not null
              constraint fk4qi1ew1ii81ipjy5p3oy5ypeq
              references users,
              constraint events_users_pkey
              primary key (event_id, user_id)
              );
  - changeSet:
      id: create_new_user_role
      author: egor.ganzya
      changes:
        - sql:
            sql: create table user_role
              (
              user_id bigint
              constraint fk_user_roles
              references users,
              roles   varchar(255) not null
              );
  - changeSet:
      id: insert_new_AdminUsers
      author: egor.ganzya
      changes:
        - insert:
            tableName: users
            columns:
              - column:
                  name: username
                  value: admin
              - column:
                  name: password
                  value: admin
              - column:
                  name: active
                  value: true
              - column:
                  name: email
                  value: dk-st31-eventmanager@yandex.ru
              - column:
                  name: phone_number
                  value: 79999999999
  - changeSet:
      id: insert_new_AdminUser_Role_1
      author: egor.ganzya
      changes:
        - sql:
            sql: insert into user_role (user_id, roles) values(1, 'USER');
        - sql:
            sql: insert into user_role (user_id, roles) values(1, 'ADMIN');
  - changeSet:
      id: update_new_Password_admin
      author: egor.ganzya
      changes:
        - sql:
            sql: CREATE EXTENSION IF NOT EXISTS pgcrypto;
        - sql:
            sql: update users set password = crypt(password, gen_salt('bf',8)) where username like 'admin';
  - changeSet:
      id: insert_new_Users
      author: egor.ganzya
      changes:
        - sql:
            sql: insert into users (username, password, active, email, phone_number) values('user', 'user', true, 'user@eventmanager.ru', '78888888888');
  - changeSet:
      id: insert_new_AdminUser_Role_2
      author: egor.ganzya
      changes:
        - sql:
            sql: insert into user_role (user_id, roles) values(2, 'USER');
  - changeSet:
      id: update_new_Password_user
      author: egor.ganzya
      changes:
        - sql:
            sql: update users set password = crypt(password, gen_salt('bf',8)) where username like 'user';
  - changeSet:
      id: insert_new_Events
      author: egor.ganzya
      changes:
        - sql:
            sql: insert into events (event_name, create_date) values('тестовый', NOW()::timestamp);
        - sql:
            sql: insert into events (event_name, create_date) values('админский', NOW()::timestamp);
  - changeSet:
      id: insert_new_EventsUsers
      author: egor.ganzya
      changes:
        - sql:
            sql: insert into events_users values(1, 1), (1, 2), (2, 1);